<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio Player TEST</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <style>
        :root {
            --color-accent: #ff007f;
            --main-bg: #121212; 
        }

        body {
            font-family: sans-serif;
            background-color: var(--main-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* --- BOTONES DE ACCIÓN --- */
        #botones-accion {
            display: flex;
            gap: 20px;
        }
        
        #btn-play, #btn-stop {
            background-color: var(--color-accent);
            color: #fff;
            border: none;
            width: 80px; 
            height: 80px;
            border-radius: 50%; 
            cursor: pointer;
            font-size: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 15px rgba(255, 0, 127, 0.9);
            transition: transform 0.2s;
            padding: 0;
        }
        #btn-play i {
             margin-left: 5px; /* Ajuste óptico */
        }
    </style>
</head>
<body>

    <h1>Heart Love FM - Test de Compatibilidad</h1>
    
    <div id="botones-accion">
        <button id="btn-stop" style="display: none;">
            <i class="fa-solid fa-stop"></i>
        </button>
        <button id="btn-play">
            <i class="fa-solid fa-play"></i>
        </button>
    </div>
    
    <audio id="radio-stream" crossorigin="anonymous" src="https://stream.zeno.fm/cr8evht2huruv"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const radio = document.getElementById('radio-stream');
            const btnPlay = document.getElementById('btn-play'); 
            const btnStop = document.getElementById('btn-stop'); 
            
            let isPlaying = false;

            // Muestra/Oculta los botones Play/Stop
            function toggleButtons(showPlay) {
                btnPlay.style.display = showPlay ? 'flex' : 'none';
                btnStop.style.display = showPlay ? 'none' : 'flex';
                // El botón de Play tendrá el icono de carga mientras intenta conectar.
                if (showPlay) {
                    btnPlay.querySelector('i').className = 'fa-solid fa-play';
                }
            }

            // MÍNIMO ESFUERZO: Solo Play y manejo de promesa
            function playRadio() {
                
                if (isPlaying) return; 

                // Mostrar icono de carga al iniciar
                btnPlay.querySelector('i').className = 'fa-solid fa-arrows-rotate fa-spin';

                radio.play().then(() => {
                    // ÉXITO
                    isPlaying = true;
                    toggleButtons(false); // Mostrar Stop

                }).catch(error => {
                    // FALLO
                    isPlaying = false;
                    toggleButtons(true); // Mostrar Play (sin carga)
                    console.error("Fallo de Play en TV:", error);
                    alert('La reproducción fue bloqueada por el navegador de la TV.');
                });
            }
            
            // MÍNIMO ESFUERZO: Solo Pause y recarga del stream
            function stopRadio() {
                if (!isPlaying) return;
                
                radio.pause();
                
                // Forzar recarga de la URL para asegurar la reconexión.
                const currentSrc = radio.src;
                radio.src = ''; 
                radio.load();
                radio.src = currentSrc;
                radio.load();
                
                isPlaying = false;
                toggleButtons(true); // Mostrar Play
            }

            btnPlay.addEventListener('click', playRadio);
            btnStop.addEventListener('click', stopRadio);
        });
    </script>
</body>
</html>
